<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <title>Jackjin's Home - 转载</title>
        <link rel="stylesheet" href="http://jackjin-cn.github.io/theme/css/main.css" />
        <link href="http://jackjin-cn.github.io/feed.xml" type="application/rss+xml" rel="alternate" title="Jackjin's Home RSS Feed" />

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="http://jackjin-cn.github.io/">Jackjin's Home </a></h1>
                <nav><ul>
                    <li><a href="http://jackjin-cn.github.io/archives.html">archives</a></li>
                    <li><a href="http://jackjin-cn.github.io/tags.html">tags</a></li>
                    <li><a href="http://jackjin-cn.github.io/categories.html">categories</a></li>
                    <li><a href="http://jackjin-cn.github.io/category/linux.html">linux</a></li>
                    <li><a href="http://jackjin-cn.github.io/category/python.html">python</a></li>
                    <li><a href="http://jackjin-cn.github.io/category/ruan-jian.html">软件</a></li>
                    <li><a href="http://jackjin-cn.github.io/category/ruan-jian-shi-yong.html">软件使用</a></li>
                    <li><a href="http://jackjin-cn.github.io/category/shell.html">shell</a></li>
                    <li><a href="http://jackjin-cn.github.io/category/vim.html">vim</a></li>
                    <li><a href="http://jackjin-cn.github.io/category/za-gan.html">杂感</a></li>
                    <li><a href="http://jackjin-cn.github.io/category/za-lei.html">杂类</a></li>
                </ul>
                </nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="http://jackjin-cn.github.io/2016/2016-01-02_20-08_zhuan-pelicande-yong-fa.html">转pelican的用法</a></h1>
<footer class="post-info">
        <span>2016-01-02 星期六 20:08</span>
<span>| tags: <a href="http://jackjin-cn.github.io/tag/pelican.html">pelican</a><a href="http://jackjin-cn.github.io/tag/zhuan-zai.html">转载</a></span>
</footer><!-- /.post-info --><p>转自<a href="http://kevinyoung.gitcafe.io/articles/blog/build_your_blog.html">煎挠橙的博客</a></p>
<blockquote>
<p>思路</p>
</blockquote>
<p>一般而言，搭建一个独立博客需要三样东西：</p>
<div class="highlight"><pre><span></span>博客软件
托管服务器
独立的域名
</pre></div>


<p>博客软件用来生成你的博客页面，而生成好的页面则需要放到托管的服务器上才能被别人看到。
博客软件</p>
<p>我选择Pleican作为博客软件主要是出于以下的考虑：</p>
<div class="highlight"><pre><span></span>基于Python，简单易上手
生成静态页面，不需要数据库，访问速度快，易于维护
支持markdown标记语言
</pre></div>


<p>和著名的wordpress相比，pelican搭建起来的博客功能和界面会相对单薄一些，但对于我来说绝对够用，况且写博客的初衷也是想把注意力放在内容上，工具越简单越好。
托管服务器</p>
<p>这里选择github的原因也很简单：</p>
<div class="highlight"><pre><span></span>免费
省事
可以直接用git进行版本管理
</pre></div>


<p>磨刀</p>
<p>这份教程中提到的方法虽然简单，但仍旧需要你有一些基础，主要有
1.python基础</p>
<p>你至少应该能够配置python的环境，能够顺利的安装python的插件,了解一些简单的python语法。
2.了解Markdown</p>
<p>没听说过不要紧，推荐阅读我的文章你为什么应该用markdown写文章。</p>
<p>另外这里有一份简短的介绍，详细的语法说明则可以在这里找到。
3.对git/github有所了解</p>
<p>如果不了解也同样没有关系，这个一站式的教程可以帮到你。</p>
<p>这里多说一点。git本身就是追踪文本的系统，虽然设定上是给程序做版本管理的，但未尝不能拿来管理文章。甚至，我相信git+markdown等轻量级标记语言代表了一种写作的未来。
动手</p>
<p>这里提一下，我的配置环境是ubuntu14.04。windows则需要多一些折腾，请自行google。
安装Pelican</p>
<p>这里假设你已经安装好了python2.x的环境，并装好了pip。可以直接用下面的命令安装pelican</p>
<p>pip install pelican</p>
<p>要使用markdown，还需要一个markdown的支持</p>
<p>pip install markdown</p>
<p>首次配置</p>
<p>选定一个目录存放你的博客文件，我的叫blog</p>
<p>mkdir blog
cd blog</p>
<p>在你的blog目录下使用命令</p>
<p>pelican-quickstart</p>
<p>接下来会询问你一系列问题，除了名字等必须要填的，其他建议使用默认值，随后还可以通过配置pelicanconf.py文件进行修改。</p>
<p>运行结束之后会生成的目录结构</p>
<p>blog/
├── content
│   └── (pages)
├── output
├── develop_server.sh
├── Makefile
├── pelicanconf.py   <br>
└── publishconf.py</p>
<p>pelican的工作逻辑是，把用markdown写好的纯文本文档放进content这个目录下面，运行程序，就可以将你的整个博客页面生成到output中去了。</p>
<p>至此，文件系统部分已经配置完成了，接下来可以试着写一篇文档了
第一篇博文</p>
<p>创建一个叫first.md的文档放到content目录下。Pelican对内容的格式有些要求，每一篇博文的开头都应该是这样的：</p>
<p>Title: 第一篇博客
Date: 2013-12-12 10:16
Category: 测试
Tags: 心情
Author: 煎挠橙</p>
<p>这里开始可以书写正文了
blabla....</p>
<p>所以你应该看明白了，必须要通过每篇博文开头的部分来告诉pelican这篇文章的标题、标签、分类等信息以便最终呈现在博客页面上。其中，标题、时间是必填的，如果缺失该文章会被pelican忽略掉。
生成网页</p>
<p>写完你的第一篇博文后，你应该还在content目录下，先回到blog根目录下</p>
<p>cd ..</p>
<p>使用下面的命令pelican系统会将你放在content目录下的.md文档转换成网页文件</p>
<p>make html</p>
<p>当然，你也可以让pelican在每次检测到文件变化的时候都重新生成一次网页，使用下面的命令</p>
<p>make regenerate</p>
<p>这时如果你去output目录下就会看到生成的页面已经躺在那里了，但为了方便本地调试，你可以用下面的命令开启一个本地的服务器</p>
<p>make serve</p>
<p>这样，通过访问 http://127.0.0.1:8000 就能看到你的博客页面了！</p>
<p>不过这样光是调试就得开两个终端，稍麻烦，pelican实际上还提供了一个命令，可以代替上面两个</p>
<p>make devserver</p>
<p>调试完毕后你应该关闭之前开启的服务器</p>
<p>./develop_server.sh stop</p>
<p>至此，尽管丑了些，但你已经完成了自己博客的创建，随后只需要把你的文章放进content目录下面并运行以上命令就可以轻松生成博客了。如果需要备份，也只需要将content目录下的文件备份好就行，非常省心。</p>
<p>当然此时别人还无法访问到你的页面，下面就教你如何把你的博客放到网上去。
在github上创建个人页面</p>
<p>首先你要有个github账号。github为每个账号提供一个子域名以供存放个人页面，使用的方法是创建一个新的版本库，命名为</p>
<p>username.github.io</p>
<p>其中username必须为你的github用户名，否则将无法启动页面。</p>
<p>这时你新创建的版本库是空的，你会获得一个地址</p>
<p>https://github.com/username/username.github.io.git</p>
<p>先记下来。</p>
<p>接下来要做的是将你本地output目录下的所有内容都推送到你刚刚建立的远程版本库中。在本地，进到output目录下面</p>
<p>cd output</p>
<p>在这里新建一个本地的版本库</p>
<p>git init</p>
<p>建议按照github的惯例添加一个新的readme文档</p>
<p>touch README.md</p>
<p>接下来可以将目录下面所有的文件都添加进缓存区</p>
<p>git add .</p>
<p>可以提交了</p>
<p>git commit -m 'First commit'</p>
<p>下面将你的本地仓库和远程仓库关联起来，还记的之前获得的一个地址吧，用在这里</p>
<p>git remote add origin https://github.com/username/username.github.io.git</p>
<p>最后将本地仓库推送到github上就好，由于是第一次，用上-u字段</p>
<p>git push -u origin master</p>
<p>待推送成功，稍等片刻，登陆</p>
<p>username.github.io</p>
<p>应该就能看到你的博客了，没错，它已经正式上线了。此后每次变更博客内容或设置，只需事后将output目录下的内容推送到github就可以了，听上去和做上去都很简单。</p>
<p>这样，如果你不在意域名的问题，你的博客就算搭建成功了，而且没有花费一分钱！
锦上添花
使用主题</p>
<p>pelican目前提供了数款主题可供选择。先到pelican这个项目的github页面上把主题的版本库clone到本地，在你选定的本地目录下面</p>
<p>git clone https://github.com/getpelican/pelican-themes.git</p>
<p>进pelican-themes目录</p>
<p>cd pelican-themes</p>
<p>你可以浏览该目录下的文件，每个子目录存放了一个主题，并有截图供你预览。比如我看中了bootstrap这一款，使用命令</p>
<p>pelican-themes -i bootstrap</p>
<p>安装该主题。再使用命令</p>
<p>pelican-themes -l</p>
<p>查看已安装主题，应该就能看到刚刚安装的bootstrap主题了。这还不够，你还需要在pelicanconf.py文档中加上一句</p>
<p>THEME = 'bootstrap'</p>
<p>这样你在生成博客页面时新主题就被应用上了。
添加静态的页面</p>
<p>pelican提供了一种不同于一般博客文章的'页面'方便你存放一些需要置顶的信息，比如about页面和contact页面。</p>
<p>创建方法也很简单，只需要在content目录下再新建一个名为pages的目录，将你想要展示的内容放进去就行，格式和普通的博客文章相同。
安装评论系统</p>
<p>由于pelican生成的是静态页面，没有数据库的支持所以本身无法实现评论的功能，不过我们还有第三方的服务可以选择。</p>
<p>这里推荐disqus，功能齐备，免费。</p>
<p>到官方页面上注册一个账号。找到'Add Disqus to your site'选项，在跳转后的页面上填写的网站名字，你填写的名字也将是你的'shortname'，记好了。</p>
<p>接下来在你的pelicanconf.py文档中添加以下字段</p>
<p>DISQUS_SITENAME = shortname</p>
<p>用你自己的'shortname'替换进去，剩下的交给pelican。
自动化</p>
<p>熟练之后会发觉整个工作流程实际上只有一下几步：</p>
<div class="highlight"><pre><span></span>进入装了pelican的python虚拟环境
打开pelican的本地调试功能
打开博客的本地页面
cd到存放博客的content目录下面
用vim编辑文章，调试
使用git将生成的网站推送到服务器上
</pre></div>


<p>虽然不多，但是用过一段时间后还是觉得繁琐，恰巧我是在ubuntu下面维护这个博客的，不搞搞自动化怎么过瘾，折腾了一下差不多可以了，下面是步骤。
期望</p>
<p>最终的实现效果大致是这样的：在终端中输入“blog”字段，自动完成上面提到的1-4步，编辑文章自然要手动，这个没的说，最后的推送部分最好也手动完成，commits还是要认真写的。
实现
1.</p>
<p>一开始先写了一个bash的脚本完成1,2两步，为什么要这样随后说，内容如下</p>
<h1>!/bin/bash</h1>
<p>. ~/virtualenvs/pelican/bin/activate #打开虚拟环境
cd /media/kevin/MainDisk/1/blog/ #cd到我的博客目录下面
bash develop_server.sh restart #打开pelican的自动监测-更新-本地端口功能
read answer #防止新打开的窗口被关闭</p>
<p>第一行主要是把python虚拟环境的配置脚本source一下，关于虚拟环境更多的信息可以参考这一篇。如果你没有在用虚拟环境则不需要这一行。</p>
<p>第二行进入到我的blog目录下面，因为相应的Makefile和bash脚本都在这里放着。</p>
<p>第三行的作用则和前面提到的make devserver一样，实际上如果你去查看Makefile的话，会发现输入make devserver执行的就是这一条命令，我不想绕弯就直接写成这样了。</p>
<p>第四行则作用则有点像你在windows下面编译c程序，因为跳出来的窗口在程序运行完之后就自动关闭，便往往在最后留一个等待输入的命令让程序先待命。</p>
<p>接着将该脚本保存为runpelicanserver.sh，更改其权限以便能够直接运行</p>
<p>$ chmod u+x runpelicanserver.sh</p>
<p>并将其放在PATH环境变量中包括的路径下面，这样随时随地都可以调用。</p>
<p>2.</p>
<p>剩下的工作我选择在.bashrc文件中编写function来完成，添加以下字段：</p>
<p>blog(){
    xfce4-terminal -e runpelicanserver.sh &amp;
    xfce4-terminal --working-directory=/media/kevin/MainDisk/1/blog/content/
    google-chrome 127.0.0.1:8000 &amp;
}</p>
<p>因为我使用的是xubuntu发行版，默认的终端是xfce4-terminal，你在使用这套东西之前应该先确认一下自己的系统配置。</p>
<p>这个func叫blog，每次我在终端中键入blog字段时，大括号里面的命令会被依次执行。</p>
<p>第一行表示重新打开一个终端窗口，-e字段表示执行后面的命令，也即runpelicanserver.sh脚本，最后的&amp;表示后台运行，因为新打开 的窗口是原来窗口的子进程，如果不后台运行的话关闭原来的窗口也会影响到新窗口的行为。要注意runpelicanserver.sh一定要放在环境变量下，不然就要加上完整的路径名。</p>
<p>第二行则表示重新打开一个终端窗口，其工作路径为我的博客路径，方便稍后编辑文章。</p>
<p>最后一行则表示使用chrome打开本地调试页面。</p>
<p>整个工作完成之后就可以达到预期的目的了。不过我遇到的一个问题是在运行runpelicanserver.sh时常常无法顺利打开pelican的本地调试端口，导致本地的页面打不开，原因不明，所以不得不重新跑一下脚本，这也是为什么把它独立出来的缘故。</p><p><a href="http://jackjin-cn.github.io/2016/2016-01-02_20-08_zhuan-pelicande-yong-fa.html#disqus_thread">comments</a></p>                </article>
<p class="paginator">
    Page 1 / 1
</p>
            </aside><!-- /#featured -->
            </ol><!-- /#posts-list -->
            </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="http://kevinyoung.gitcafe.io">煎挠橙的blog</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://jackjin-cn.github.io/feed.xml" type="application/rss+xml" rel="alternate">rss feed</a></li>

                            <li><a href="#">aiwanke</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <p>Powered by <a href="http://getpelican.com/">Pelican</a>. Theme <a href="https://github.com/blueicefield/pelican-blueidea/">blueidea</a>, inspired by the default theme.</p>
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-72007782-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
<script type="text/javascript">
    var disqus_shortname = 'jackjin';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>